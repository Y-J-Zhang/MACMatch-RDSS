---------  --------------------------------
Building G
Backbone: resnet18
# params: 11,176,512
Building C
# params: 66,560
Loading evaluator: Classification
No checkpoint found, train from scratch
Initialize tensorboard (log_dir=output/20230814/fact_mixstyle_fea_gaosi2_10seed/ssdg_officehome/nlab_975/StyleMatch/resnet18/v1/clipart/seed9/tensorboard)
epoch [1/20] batch [10/28] time 1.530 (2.332) data 0.001 (0.413) loss_x 7.7916 (11.3513) loss_u_aug 0.1771 (0.0202) loss_u_sty 0.2436 (0.0270) y_u_pred_acc_thre 1.0000 (0.2000) y_u_pred_acc_raw 0.4479 (0.1938) y_u_pred_keep_rate 0.0312 (0.0036) lr 3.0000e-03 eta 0:21:22
epoch [1/20] batch [20/28] time 1.504 (2.087) data 0.000 (0.373) loss_x 3.0291 (7.9159) loss_u_aug 0.4325 (0.1890) loss_u_sty 0.6835 (0.2709) y_u_pred_acc_thre 0.9722 (0.5828) y_u_pred_acc_raw 0.6458 (0.3833) y_u_pred_keep_rate 0.1875 (0.0549) lr 3.0000e-03 eta 0:18:46
epoch [2/20] batch [10/28] time 1.511 (1.840) data 0.001 (0.321) loss_x 1.3089 (1.4371) loss_u_aug 0.4668 (0.5079) loss_u_sty 1.0088 (0.9081) y_u_pred_acc_thre 0.9783 (0.9786) y_u_pred_acc_raw 0.7188 (0.6484) y_u_pred_keep_rate 0.2396 (0.2047) lr 2.9815e-03 eta 0:16:00
epoch [2/20] batch [20/28] time 1.511 (1.860) data 0.001 (0.343) loss_x 0.7362 (1.1763) loss_u_aug 0.4627 (0.5095) loss_u_sty 0.9525 (0.9244) y_u_pred_acc_thre 0.9583 (0.9701) y_u_pred_acc_raw 0.6562 (0.6690) y_u_pred_keep_rate 0.2500 (0.2234) lr 2.9815e-03 eta 0:15:52
epoch [3/20] batch [10/28] time 1.522 (1.871) data 0.001 (0.352) loss_x 0.5217 (0.5325) loss_u_aug 0.7031 (0.6181) loss_u_sty 1.1950 (1.0490) y_u_pred_acc_thre 1.0000 (0.9722) y_u_pred_acc_raw 0.7448 (0.6750) y_u_pred_keep_rate 0.3125 (0.2766) lr 2.9266e-03 eta 0:15:24
epoch [3/20] batch [20/28] time 1.517 (1.859) data 0.001 (0.341) loss_x 0.4110 (0.4818) loss_u_aug 0.5919 (0.6103) loss_u_sty 0.9314 (1.0639) y_u_pred_acc_thre 0.9836 (0.9701) y_u_pred_acc_raw 0.7292 (0.6784) y_u_pred_keep_rate 0.3177 (0.2945) lr 2.9266e-03 eta 0:14:59
epoch [4/20] batch [10/28] time 1.517 (1.863) data 0.001 (0.351) loss_x 0.3214 (0.2994) loss_u_aug 0.9381 (0.6734) loss_u_sty 0.9757 (1.0547) y_u_pred_acc_thre 0.9394 (0.9609) y_u_pred_acc_raw 0.7240 (0.6953) y_u_pred_keep_rate 0.3438 (0.3365) lr 2.8365e-03 eta 0:14:28
epoch [4/20] batch [20/28] time 1.506 (1.859) data 0.001 (0.347) loss_x 0.2851 (0.2785) loss_u_aug 0.7295 (0.6582) loss_u_sty 1.1039 (1.0854) y_u_pred_acc_thre 0.9726 (0.9657) y_u_pred_acc_raw 0.6771 (0.6945) y_u_pred_keep_rate 0.3802 (0.3354) lr 2.8365e-03 eta 0:14:07
epoch [5/20] batch [10/28] time 1.505 (1.856) data 0.001 (0.346) loss_x 0.1538 (0.1879) loss_u_aug 0.5756 (0.6105) loss_u_sty 1.0552 (1.0633) y_u_pred_acc_thre 0.9655 (0.9554) y_u_pred_acc_raw 0.6458 (0.6885) y_u_pred_keep_rate 0.3021 (0.3396) lr 2.7135e-03 eta 0:13:32
epoch [5/20] batch [20/28] time 1.507 (1.859) data 0.001 (0.346) loss_x 0.1571 (0.1777) loss_u_aug 0.9063 (0.6599) loss_u_sty 1.2699 (1.1036) y_u_pred_acc_thre 0.9600 (0.9614) y_u_pred_acc_raw 0.7448 (0.6997) y_u_pred_keep_rate 0.3906 (0.3695) lr 2.7135e-03 eta 0:13:15
epoch [6/20] batch [10/28] time 1.509 (1.854) data 0.000 (0.344) loss_x 0.1371 (0.1319) loss_u_aug 0.6755 (0.7045) loss_u_sty 1.0215 (1.1258) y_u_pred_acc_thre 0.9506 (0.9600) y_u_pred_acc_raw 0.6979 (0.6979) y_u_pred_keep_rate 0.4219 (0.3974) lr 2.5607e-03 eta 0:12:40
epoch [6/20] batch [20/28] time 1.507 (1.850) data 0.001 (0.340) loss_x 0.1048 (0.1197) loss_u_aug 0.6593 (0.7166) loss_u_sty 0.9841 (1.1029) y_u_pred_acc_thre 0.9857 (0.9616) y_u_pred_acc_raw 0.6927 (0.6964) y_u_pred_keep_rate 0.3646 (0.3906) lr 2.5607e-03 eta 0:12:19
epoch [7/20] batch [10/28] time 1.500 (1.845) data 0.000 (0.337) loss_x 0.0811 (0.0938) loss_u_aug 0.6394 (0.7017) loss_u_sty 1.0611 (1.0710) y_u_pred_acc_thre 0.9733 (0.9490) y_u_pred_acc_raw 0.7031 (0.6865) y_u_pred_keep_rate 0.3906 (0.4083) lr 2.3817e-03 eta 0:11:44
epoch [7/20] batch [20/28] time 1.507 (1.844) data 0.000 (0.334) loss_x 0.0977 (0.0901) loss_u_aug 0.7413 (0.6777) loss_u_sty 0.9502 (0.9993) y_u_pred_acc_thre 0.9398 (0.9475) y_u_pred_acc_raw 0.7188 (0.6938) y_u_pred_keep_rate 0.4323 (0.4180) lr 2.3817e-03 eta 0:11:25
epoch [8/20] batch [10/28] time 1.522 (1.845) data 0.001 (0.322) loss_x 0.0780 (0.0688) loss_u_aug 0.8755 (0.6793) loss_u_sty 0.9372 (0.9343) y_u_pred_acc_thre 0.9610 (0.9587) y_u_pred_acc_raw 0.6875 (0.7021) y_u_pred_keep_rate 0.4010 (0.4083) lr 2.1810e-03 eta 0:10:53
epoch [8/20] batch [20/28] time 1.516 (1.870) data 0.001 (0.351) loss_x 0.0603 (0.0653) loss_u_aug 0.4416 (0.6433) loss_u_sty 1.1003 (0.9884) y_u_pred_acc_thre 0.9540 (0.9524) y_u_pred_acc_raw 0.6719 (0.7008) y_u_pred_keep_rate 0.4531 (0.4201) lr 2.1810e-03 eta 0:10:43
epoch [9/20] batch [10/28] time 1.518 (1.839) data 0.001 (0.316) loss_x 0.0559 (0.0631) loss_u_aug 0.5993 (0.6586) loss_u_sty 0.8673 (0.8625) y_u_pred_acc_thre 0.9610 (0.9507) y_u_pred_acc_raw 0.6823 (0.7031) y_u_pred_keep_rate 0.4010 (0.4448) lr 1.9635e-03 eta 0:09:59
epoch [9/20] batch [20/28] time 1.508 (1.843) data 0.001 (0.326) loss_x 0.0484 (0.0584) loss_u_aug 0.6376 (0.6250) loss_u_sty 0.7630 (0.8938) y_u_pred_acc_thre 0.9659 (0.9504) y_u_pred_acc_raw 0.6927 (0.7018) y_u_pred_keep_rate 0.4583 (0.4438) lr 1.9635e-03 eta 0:09:42
epoch [10/20] batch [10/28] time 1.497 (1.858) data 0.001 (0.346) loss_x 0.0396 (0.0470) loss_u_aug 0.3884 (0.6949) loss_u_sty 0.6438 (0.9381) y_u_pred_acc_thre 0.9333 (0.9296) y_u_pred_acc_raw 0.7083 (0.6927) y_u_pred_keep_rate 0.4688 (0.4552) lr 1.7347e-03 eta 0:09:13
epoch [10/20] batch [20/28] time 1.520 (1.853) data 0.000 (0.339) loss_x 0.0399 (0.0459) loss_u_aug 0.6673 (0.6918) loss_u_sty 0.8848 (0.9497) y_u_pred_acc_thre 0.9247 (0.9345) y_u_pred_acc_raw 0.7344 (0.6984) y_u_pred_keep_rate 0.4844 (0.4549) lr 1.7347e-03 eta 0:08:53
epoch [11/20] batch [10/28] time 1.516 (1.827) data 0.001 (0.312) loss_x 0.0442 (0.0434) loss_u_aug 0.4821 (0.6070) loss_u_sty 0.7952 (0.8066) y_u_pred_acc_thre 0.9079 (0.9442) y_u_pred_acc_raw 0.6927 (0.7135) y_u_pred_keep_rate 0.3958 (0.4401) lr 1.5000e-03 eta 0:08:13
epoch [11/20] batch [20/28] time 1.515 (1.843) data 0.001 (0.328) loss_x 0.0396 (0.0418) loss_u_aug 0.5085 (0.6097) loss_u_sty 0.7588 (0.8362) y_u_pred_acc_thre 0.9474 (0.9519) y_u_pred_acc_raw 0.6875 (0.7026) y_u_pred_keep_rate 0.4948 (0.4531) lr 1.5000e-03 eta 0:07:59
epoch [12/20] batch [10/28] time 1.522 (1.813) data 0.001 (0.298) loss_x 0.0336 (0.0376) loss_u_aug 0.3519 (0.5363) loss_u_sty 0.6268 (0.7831) y_u_pred_acc_thre 0.9231 (0.9398) y_u_pred_acc_raw 0.6979 (0.6995) y_u_pred_keep_rate 0.4740 (0.4547) lr 1.2653e-03 eta 0:07:18
epoch [12/20] batch [20/28] time 1.513 (1.838) data 0.001 (0.326) loss_x 0.0403 (0.0370) loss_u_aug 0.5353 (0.5662) loss_u_sty 0.8209 (0.7914) y_u_pred_acc_thre 0.9588 (0.9503) y_u_pred_acc_raw 0.7188 (0.6997) y_u_pred_keep_rate 0.5052 (0.4560) lr 1.2653e-03 eta 0:07:06
epoch [13/20] batch [10/28] time 1.502 (1.825) data 0.001 (0.315) loss_x 0.0332 (0.0330) loss_u_aug 0.5146 (0.5790) loss_u_sty 0.6465 (0.8309) y_u_pred_acc_thre 0.9293 (0.9493) y_u_pred_acc_raw 0.6615 (0.7245) y_u_pred_keep_rate 0.5156 (0.4813) lr 1.0365e-03 eta 0:06:30
epoch [13/20] batch [20/28] time 1.511 (1.834) data 0.001 (0.325) loss_x 0.0326 (0.0323) loss_u_aug 0.4374 (0.6043) loss_u_sty 0.6104 (0.8039) y_u_pred_acc_thre 0.9474 (0.9437) y_u_pred_acc_raw 0.6927 (0.7128) y_u_pred_keep_rate 0.3958 (0.4784) lr 1.0365e-03 eta 0:06:14
epoch [14/20] batch [10/28] time 1.512 (1.840) data 0.001 (0.326) loss_x 0.0263 (0.0304) loss_u_aug 0.7794 (0.5789) loss_u_sty 0.5659 (0.7799) y_u_pred_acc_thre 0.9670 (0.9448) y_u_pred_acc_raw 0.6979 (0.7120) y_u_pred_keep_rate 0.4740 (0.4740) lr 8.1901e-04 eta 0:05:42
epoch [14/20] batch [20/28] time 1.507 (1.854) data 0.001 (0.342) loss_x 0.0253 (0.0302) loss_u_aug 0.5402 (0.6030) loss_u_sty 0.5125 (0.7674) y_u_pred_acc_thre 0.9432 (0.9529) y_u_pred_acc_raw 0.7031 (0.7128) y_u_pred_keep_rate 0.4583 (0.4758) lr 8.1901e-04 eta 0:05:26
epoch [15/20] batch [10/28] time 1.506 (1.854) data 0.001 (0.335) loss_x 0.0251 (0.0321) loss_u_aug 0.6687 (0.5942) loss_u_sty 0.8044 (0.7053) y_u_pred_acc_thre 0.9130 (0.9355) y_u_pred_acc_raw 0.6562 (0.6958) y_u_pred_keep_rate 0.4792 (0.4885) lr 6.1832e-04 eta 0:04:53
epoch [15/20] batch [20/28] time 1.516 (1.854) data 0.000 (0.338) loss_x 0.0254 (0.0308) loss_u_aug 0.5418 (0.5547) loss_u_sty 0.8096 (0.7451) y_u_pred_acc_thre 0.9333 (0.9383) y_u_pred_acc_raw 0.7188 (0.7000) y_u_pred_keep_rate 0.4688 (0.4849) lr 6.1832e-04 eta 0:04:34
epoch [16/20] batch [10/28] time 1.513 (1.827) data 0.001 (0.310) loss_x 0.0303 (0.0276) loss_u_aug 0.4979 (0.5157) loss_u_sty 0.9375 (0.8170) y_u_pred_acc_thre 0.9518 (0.9460) y_u_pred_acc_raw 0.6510 (0.6896) y_u_pred_keep_rate 0.4323 (0.4672) lr 4.3934e-04 eta 0:03:57
epoch [16/20] batch [20/28] time 1.521 (1.845) data 0.001 (0.327) loss_x 0.0318 (0.0272) loss_u_aug 0.7710 (0.5149) loss_u_sty 0.7662 (0.8086) y_u_pred_acc_thre 0.9691 (0.9440) y_u_pred_acc_raw 0.7552 (0.6966) y_u_pred_keep_rate 0.5052 (0.4742) lr 4.3934e-04 eta 0:03:41
epoch [17/20] batch [10/28] time 1.530 (1.858) data 0.001 (0.343) loss_x 0.0294 (0.0291) loss_u_aug 0.5237 (0.5711) loss_u_sty 0.7045 (0.7543) y_u_pred_acc_thre 0.9307 (0.9485) y_u_pred_acc_raw 0.7812 (0.7313) y_u_pred_keep_rate 0.5260 (0.5151) lr 2.8647e-04 eta 0:03:09
epoch [17/20] batch [20/28] time 1.519 (1.856) data 0.001 (0.343) loss_x 0.0274 (0.0281) loss_u_aug 0.6516 (0.5666) loss_u_sty 0.7265 (0.7637) y_u_pred_acc_thre 0.9406 (0.9424) y_u_pred_acc_raw 0.6979 (0.7081) y_u_pred_keep_rate 0.5260 (0.4932) lr 2.8647e-04 eta 0:02:50
epoch [18/20] batch [10/28] time 1.530 (1.861) data 0.001 (0.342) loss_x 0.0258 (0.0260) loss_u_aug 0.6342 (0.5715) loss_u_sty 1.1086 (0.8354) y_u_pred_acc_thre 0.9524 (0.9383) y_u_pred_acc_raw 0.7552 (0.7078) y_u_pred_keep_rate 0.5469 (0.5115) lr 1.6349e-04 eta 0:02:17
epoch [18/20] batch [20/28] time 1.517 (1.870) data 0.001 (0.353) loss_x 0.0304 (0.0270) loss_u_aug 0.4262 (0.5106) loss_u_sty 0.8254 (0.7828) y_u_pred_acc_thre 0.9709 (0.9400) y_u_pred_acc_raw 0.7083 (0.7107) y_u_pred_keep_rate 0.5365 (0.5060) lr 1.6349e-04 eta 0:01:59
epoch [19/20] batch [10/28] time 1.514 (1.842) data 0.001 (0.320) loss_x 0.0260 (0.0268) loss_u_aug 0.3536 (0.4849) loss_u_sty 0.7213 (0.7342) y_u_pred_acc_thre 0.9348 (0.9393) y_u_pred_acc_raw 0.7031 (0.7068) y_u_pred_keep_rate 0.4792 (0.5021) lr 7.3415e-05 eta 0:01:24
epoch [19/20] batch [20/28] time 1.521 (1.848) data 0.001 (0.329) loss_x 0.0256 (0.0270) loss_u_aug 0.5281 (0.4912) loss_u_sty 0.5804 (0.7534) y_u_pred_acc_thre 0.9780 (0.9394) y_u_pred_acc_raw 0.7188 (0.7036) y_u_pred_keep_rate 0.4740 (0.4966) lr 7.3415e-05 eta 0:01:06
epoch [20/20] batch [10/28] time 1.523 (1.864) data 0.001 (0.346) loss_x 0.0246 (0.0255) loss_u_aug 0.5426 (0.5369) loss_u_sty 0.8740 (0.7172) y_u_pred_acc_thre 0.9213 (0.9276) y_u_pred_acc_raw 0.7604 (0.7068) y_u_pred_keep_rate 0.4635 (0.4844) lr 1.8467e-05 eta 0:00:33
epoch [20/20] batch [20/28] time 1.516 (1.851) data 0.001 (0.335) loss_x 0.0357 (0.0268) loss_u_aug 0.5939 (0.5418) loss_u_sty 0.6381 (0.7177) y_u_pred_acc_thre 0.9787 (0.9337) y_u_pred_acc_raw 0.6875 (0.7070) y_u_pred_keep_rate 0.4896 (0.4969) lr 1.8467e-05 eta 0:00:14
Checkpoint saved to output/20230814/fact_mixstyle_fea_gaosi2_10seed/ssdg_officehome/nlab_975/StyleMatch/resnet18/v1/clipart/seed9/G/model.pth.tar-20
Checkpoint saved to output/20230814/fact_mixstyle_fea_gaosi2_10seed/ssdg_officehome/nlab_975/StyleMatch/resnet18/v1/clipart/seed9/C/model.pth.tar-20
Finish training
Evaluate on the *test* set
=> result
* total: 4,365
* correct: 2,258
* accuracy: 51.7%
* error: 48.3%
* macro_f1: 48.9%
Checkpoint saved to output/20230814/fact_mixstyle_fea_gaosi2_10seed/ssdg_officehome/nlab_975/StyleMatch/resnet18/v1/clipart/seed9/G/model.pth.tar-20
Checkpoint saved to output/20230814/fact_mixstyle_fea_gaosi2_10seed/ssdg_officehome/nlab_975/StyleMatch/resnet18/v1/clipart/seed9/C/model.pth.tar-20
Elapsed: 0:19:07
